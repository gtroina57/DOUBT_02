<script>
const ws = new WebSocket("wss://doubt-02.onrender.com/ws");
const inputBox = document.getElementById("user-input");
const sendButton = document.getElementById("send-button");

// ðŸ”’ Initially disable input
inputBox.disabled = true;
sendButton.disabled = true;

socket.onmessage = function(event) {
    const msg = event.data;

    if (msg === "__USER_PROXY_TURN__") {
        // âœ… It's the user's turn
        inputBox.disabled = false;
        sendButton.disabled = false;
        inputBox.focus();

        // Optional: notify user visually
        console.log("ðŸŽ¤ It's your turn to speak.");
    } else {
        // ðŸ“¥ Handle normal bot message
        appendToChatLog("ðŸ¤–", msg);
    }
};

sendButton.addEventListener("click", () => {
    const message = inputBox.value.trim();
    if (message === "") return;

    socket.send(message);

    // â›” Disable input after sending, wait for next prompt
    inputBox.value = "";
    inputBox.disabled = true;
    sendButton.disabled = true;
});

function appendToChatLog(sender, message) {
    const chatLog = document.getElementById("chat-log");
    const entry = document.createElement("div");
    entry.textContent = `${sender}: ${message}`;
    chatLog.appendChild(entry);
}
</script>